2023-01-26 03:17:23,119:INFO: Building model...
2023-01-26 03:17:24,405:INFO: - done.
2023-01-26 03:17:24,407:INFO: Epoch 1/30
2023-01-26 04:27:25,929:INFO: - Training:  - 4201s - loss: 1.1158 - perplexity: 3.1035 - lr: 0.0001
2023-01-26 04:33:15,196:INFO: - Eval: BLEU-4 28.50 - EM 0.00 - Edit 58.88 - perplexity -2.53
2023-01-26 04:33:15,197:INFO: - New best score (-2.53)!
2023-01-26 04:33:16,442:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 04:33:16,443:INFO: - Elapsed time: 4552.04, lr: 0.00010
2023-01-26 04:33:16,443:INFO: Epoch 2/30
2023-01-26 05:43:17,918:INFO: - Training:  - 4201s - loss: 0.8804 - perplexity: 2.4149 - lr: 0.0001
2023-01-26 05:49:33,261:INFO: - Eval: BLEU-4 31.43 - EM 0.00 - Edit 60.54 - perplexity -2.33
2023-01-26 05:49:33,262:INFO: - New best score (-2.33)!
2023-01-26 05:49:34,467:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 05:49:34,468:INFO: - Elapsed time: 4578.02, lr: 0.00010
2023-01-26 05:49:34,469:INFO: Epoch 3/30
2023-01-26 06:59:32,730:INFO: - Training:  - 4198s - loss: 0.8323 - perplexity: 2.3003 - lr: 0.0001
2023-01-26 07:05:47,330:INFO: - Eval: BLEU-4 33.91 - EM 0.00 - Edit 59.40 - perplexity -2.29
2023-01-26 07:05:47,331:INFO: - New best score (-2.29)!
2023-01-26 07:05:48,589:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 07:05:48,590:INFO: - Elapsed time: 4574.12, lr: 0.00010
2023-01-26 07:05:48,591:INFO: Epoch 4/30
2023-01-26 08:15:32,722:INFO: - Training:  - 4184s - loss: 0.7835 - perplexity: 2.1912 - lr: 0.0001
2023-01-26 08:22:19,040:INFO: - Eval: BLEU-4 33.76 - EM 0.00 - Edit 61.10 - perplexity -2.10
2023-01-26 08:22:19,041:INFO: - New best score (-2.10)!
2023-01-26 08:22:20,240:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 08:22:20,241:INFO: - Elapsed time: 4591.65, lr: 0.00010
2023-01-26 08:22:20,242:INFO: Epoch 5/30
2023-01-26 09:32:06,617:INFO: - Training:  - 4186s - loss: 0.7041 - perplexity: 2.0240 - lr: 0.0001
2023-01-26 09:38:43,623:INFO: - Eval: BLEU-4 35.22 - EM 0.00 - Edit 63.38 - perplexity -2.11
2023-01-26 09:38:43,624:INFO: - Elapsed time: 4583.38, lr: 0.00010
2023-01-26 09:38:43,625:INFO: Epoch 6/30
2023-01-26 10:48:17,003:INFO: - Training:  - 4173s - loss: 0.6294 - perplexity: 1.8781 - lr: 0.0001
2023-01-26 10:55:10,073:INFO: - Eval: BLEU-4 49.40 - EM 0.00 - Edit 64.88 - perplexity -1.94
2023-01-26 10:55:10,074:INFO: - New best score (-1.94)!
2023-01-26 10:55:11,264:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 10:55:11,264:INFO: - Elapsed time: 4587.64, lr: 0.00010
2023-01-26 10:55:11,265:INFO: Epoch 7/30
2023-01-26 12:04:50,769:INFO: - Training:  - 4179s - loss: 0.5734 - perplexity: 1.7756 - lr: 0.0001
2023-01-26 12:11:51,638:INFO: - Eval: BLEU-4 52.44 - EM 0.00 - Edit 66.40 - perplexity -1.74
2023-01-26 12:11:51,639:INFO: - New best score (-1.74)!
2023-01-26 12:11:53,028:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 12:11:53,029:INFO: - Elapsed time: 4601.76, lr: 0.00010
2023-01-26 12:11:53,029:INFO: Epoch 8/30
2023-01-26 13:21:31,352:INFO: - Training:  - 4178s - loss: 0.5182 - perplexity: 1.6803 - lr: 0.0001
2023-01-26 13:28:49,640:INFO: - Eval: BLEU-4 58.41 - EM 0.00 - Edit 67.65 - perplexity -1.75
2023-01-26 13:28:49,643:INFO: - Elapsed time: 4616.61, lr: 0.00010
2023-01-26 13:28:49,644:INFO: Epoch 9/30
2023-01-26 14:39:00,078:INFO: - Training:  - 4210s - loss: 0.4661 - perplexity: 1.5952 - lr: 0.0001
2023-01-26 14:46:02,871:INFO: - Eval: BLEU-4 63.60 - EM 0.12 - Edit 69.70 - perplexity -1.64
2023-01-26 14:46:02,872:INFO: - New best score (-1.64)!
2023-01-26 14:46:04,091:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 14:46:04,092:INFO: - Elapsed time: 4634.45, lr: 0.00010
2023-01-26 14:46:04,092:INFO: Epoch 10/30
2023-01-26 15:57:16,644:INFO: - Training:  - 4272s - loss: 0.4122 - perplexity: 1.5114 - lr: 0.0001
2023-01-26 16:04:29,597:INFO: - Eval: BLEU-4 66.90 - EM 0.49 - Edit 72.12 - perplexity -1.55
2023-01-26 16:04:29,598:INFO: - New best score (-1.55)!
2023-01-26 16:04:31,051:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 16:04:31,065:INFO: - Elapsed time: 4706.97, lr: 0.00010
2023-01-26 16:04:31,066:INFO: Epoch 11/30
2023-01-26 17:15:18,286:INFO: - Training:  - 4247s - loss: 0.3706 - perplexity: 1.4496 - lr: 0.0001
2023-01-26 17:22:21,415:INFO: - Eval: BLEU-4 65.46 - EM 1.10 - Edit 72.93 - perplexity -1.50
2023-01-26 17:22:21,416:INFO: - New best score (-1.50)!
2023-01-26 17:22:22,683:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 17:22:22,684:INFO: - Elapsed time: 4671.62, lr: 0.00010
2023-01-26 17:22:22,685:INFO: Epoch 12/30
2023-01-26 18:33:01,000:INFO: - Training:  - 4238s - loss: 0.3309 - perplexity: 1.3933 - lr: 0.0001
2023-01-26 18:40:14,058:INFO: - Eval: BLEU-4 68.82 - EM 2.44 - Edit 73.87 - perplexity -1.48
2023-01-26 18:40:14,059:INFO: - New best score (-1.48)!
2023-01-26 18:40:15,423:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 18:40:15,423:INFO: - Elapsed time: 4672.74, lr: 0.00010
2023-01-26 18:40:15,424:INFO: Epoch 13/30
2023-01-26 19:50:38,614:INFO: - Training:  - 4223s - loss: 0.2993 - perplexity: 1.3499 - lr: 0.0001
2023-01-26 19:57:48,149:INFO: - Eval: BLEU-4 71.04 - EM 4.52 - Edit 75.41 - perplexity -1.42
2023-01-26 19:57:48,150:INFO: - New best score (-1.42)!
2023-01-26 19:57:49,444:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 19:57:49,445:INFO: - Elapsed time: 4654.02, lr: 0.00010
2023-01-26 19:57:49,445:INFO: Epoch 14/30
2023-01-26 21:08:39,731:INFO: - Training:  - 4250s - loss: 0.2683 - perplexity: 1.3086 - lr: 0.0001
2023-01-26 21:15:44,997:INFO: - Eval: BLEU-4 71.76 - EM 5.38 - Edit 76.13 - perplexity -1.37
2023-01-26 21:15:44,998:INFO: - New best score (-1.37)!
2023-01-26 21:15:46,243:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 21:15:46,244:INFO: - Elapsed time: 4676.80, lr: 0.00010
2023-01-26 21:15:46,244:INFO: Epoch 15/30
2023-01-26 22:25:23,623:INFO: - Training:  - 4177s - loss: 0.2456 - perplexity: 1.2792 - lr: 0.0001
2023-01-26 22:32:28,523:INFO: - Eval: BLEU-4 74.00 - EM 7.21 - Edit 77.36 - perplexity -1.34
2023-01-26 22:32:28,523:INFO: - New best score (-1.34)!
2023-01-26 22:32:29,753:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 22:32:29,754:INFO: - Elapsed time: 4603.51, lr: 0.00010
2023-01-26 22:32:29,754:INFO: Epoch 16/30
2023-01-26 23:42:08,765:INFO: - Training:  - 4179s - loss: 0.2292 - perplexity: 1.2584 - lr: 0.0001
2023-01-26 23:49:20,148:INFO: - Eval: BLEU-4 76.05 - EM 13.94 - Edit 79.26 - perplexity -1.31
2023-01-26 23:49:20,149:INFO: - New best score (-1.31)!
2023-01-26 23:49:21,398:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-26 23:49:21,398:INFO: - Elapsed time: 4611.64, lr: 0.00010
2023-01-26 23:49:21,399:INFO: Epoch 17/30
2023-01-27 01:00:39,126:INFO: - Training:  - 4277s - loss: 0.2126 - perplexity: 1.2376 - lr: 0.0001
2023-01-27 01:08:06,291:INFO: - Eval: BLEU-4 75.29 - EM 9.41 - Edit 78.20 - perplexity -1.35
2023-01-27 01:08:06,293:INFO: - Elapsed time: 4724.89, lr: 0.00010
2023-01-27 01:08:06,293:INFO: Epoch 18/30
2023-01-27 02:19:57,061:INFO: - Training:  - 4310s - loss: 0.1928 - perplexity: 1.2133 - lr: 0.0001
2023-01-27 02:27:12,056:INFO: - Eval: BLEU-4 78.23 - EM 13.69 - Edit 79.87 - perplexity -1.30
2023-01-27 02:27:12,057:INFO: - New best score (-1.30)!
2023-01-27 02:27:13,682:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-27 02:27:13,683:INFO: - Elapsed time: 4747.39, lr: 0.00010
2023-01-27 02:27:13,684:INFO: Epoch 19/30
2023-01-27 03:36:15,953:INFO: - Training:  - 4142s - loss: 0.1794 - perplexity: 1.1971 - lr: 0.0001
2023-01-27 03:43:33,184:INFO: - Eval: BLEU-4 76.82 - EM 7.33 - Edit 79.63 - perplexity -1.38
2023-01-27 03:43:33,185:INFO: - Elapsed time: 4579.50, lr: 0.00010
2023-01-27 03:43:33,185:INFO: Epoch 20/30
2023-01-27 04:52:39,118:INFO: - Training:  - 4145s - loss: 0.1693 - perplexity: 1.1851 - lr: 0.0001
2023-01-27 04:59:51,219:INFO: - Eval: BLEU-4 77.58 - EM 11.00 - Edit 80.07 - perplexity -1.34
2023-01-27 04:59:51,219:INFO: - Elapsed time: 4578.03, lr: 0.00010
2023-01-27 04:59:51,220:INFO: Epoch 21/30
2023-01-27 06:08:52,561:INFO: - Training:  - 4141s - loss: 0.1514 - perplexity: 1.1641 - lr: 0.0001
2023-01-27 06:16:01,129:INFO: - Eval: BLEU-4 78.77 - EM 11.00 - Edit 80.16 - perplexity -1.33
2023-01-27 06:16:01,129:INFO: - Elapsed time: 4569.91, lr: 0.00010
2023-01-27 06:16:01,130:INFO: Epoch 22/30
2023-01-27 07:25:17,642:INFO: - Training:  - 4156s - loss: 0.1401 - perplexity: 1.1510 - lr: 0.0001
2023-01-27 07:32:32,488:INFO: - Eval: BLEU-4 79.99 - EM 13.81 - Edit 81.18 - perplexity -1.33
2023-01-27 07:32:32,489:INFO: - Elapsed time: 4591.36, lr: 0.00010
2023-01-27 07:32:32,489:INFO: Epoch 23/30
2023-01-27 08:41:46,559:INFO: - Training:  - 4154s - loss: 0.1265 - perplexity: 1.1354 - lr: 0.0001
2023-01-27 08:49:08,173:INFO: - Eval: BLEU-4 82.74 - EM 24.45 - Edit 83.00 - perplexity -1.24
2023-01-27 08:49:08,173:INFO: - New best score (-1.24)!
2023-01-27 08:49:09,453:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-27 08:49:09,454:INFO: - Elapsed time: 4596.97, lr: 0.00010
2023-01-27 08:49:09,454:INFO: Epoch 24/30
2023-01-27 09:58:27,324:INFO: - Training:  - 4157s - loss: 0.1099 - perplexity: 1.1165 - lr: 0.0001
2023-01-27 10:05:42,943:INFO: - Eval: BLEU-4 82.82 - EM 25.79 - Edit 83.27 - perplexity -1.24
2023-01-27 10:05:42,944:INFO: - New best score (-1.24)!
2023-01-27 10:05:44,420:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-27 10:05:44,420:INFO: - Elapsed time: 4594.97, lr: 0.00010
2023-01-27 10:05:44,421:INFO: Epoch 25/30
2023-01-27 11:15:01,072:INFO: - Training:  - 4156s - loss: 0.1041 - perplexity: 1.1101 - lr: 0.0001
2023-01-27 11:22:19,674:INFO: - Eval: BLEU-4 82.72 - EM 22.98 - Edit 82.73 - perplexity -1.27
2023-01-27 11:22:19,675:INFO: - Elapsed time: 4595.25, lr: 0.00010
2023-01-27 11:22:19,676:INFO: Epoch 26/30
2023-01-27 12:31:37,803:INFO: - Training:  - 4158s - loss: 0.0992 - perplexity: 1.1047 - lr: 0.0001
2023-01-27 12:38:59,413:INFO: - Eval: BLEU-4 83.10 - EM 25.79 - Edit 83.67 - perplexity -1.26
2023-01-27 12:38:59,414:INFO: - Elapsed time: 4599.74, lr: 0.00010
2023-01-27 12:38:59,415:INFO: Epoch 27/30
2023-01-27 13:48:50,741:INFO: - Training:  - 4191s - loss: 0.0928 - perplexity: 1.0976 - lr: 0.0001
2023-01-27 13:56:27,441:INFO: - Eval: BLEU-4 82.85 - EM 25.55 - Edit 83.72 - perplexity -1.27
2023-01-27 13:56:27,441:INFO: - Elapsed time: 4648.03, lr: 0.00010
2023-01-27 13:56:27,442:INFO: Epoch 28/30
2023-01-27 15:05:45,156:INFO: - Training:  - 4157s - loss: 0.0836 - perplexity: 1.0875 - lr: 0.0001
2023-01-27 15:13:10,304:INFO: - Eval: BLEU-4 82.56 - EM 24.45 - Edit 82.91 - perplexity -1.29
2023-01-27 15:13:10,305:INFO: - Elapsed time: 4602.86, lr: 0.00010
2023-01-27 15:13:10,305:INFO: Epoch 29/30
2023-01-27 16:23:04,904:INFO: - Training:  - 4194s - loss: 0.0778 - perplexity: 1.0813 - lr: 0.0001
2023-01-27 16:30:24,939:INFO: - Eval: BLEU-4 81.47 - EM 22.00 - Edit 82.56 - perplexity -1.33
2023-01-27 16:30:24,940:INFO: - Elapsed time: 4634.63, lr: 0.00010
2023-01-27 16:30:24,940:INFO: Epoch 30/30
2023-01-27 17:40:05,891:INFO: - Training:  - 4180s - loss: 0.0721 - perplexity: 1.0751 - lr: 0.0001
2023-01-27 17:47:23,574:INFO: - Eval: BLEU-4 84.91 - EM 30.81 - Edit 85.10 - perplexity -1.27
2023-01-27 17:47:23,575:INFO: - Elapsed time: 4618.64, lr: 0.00010
2023-01-28 00:12:38,220:INFO: Building model...
2023-01-28 00:12:38,947:INFO: - done.
2023-01-28 00:12:38,947:INFO: Reloading the latest trained model...
2023-01-28 00:12:38,948:INFO: Restoring parameters from results/clean-RDKit-10K/model.weights/
2023-01-28 00:20:27,243:INFO: - Test Txt: BLEU-4 83.22 - EM 24.75 - Edit 83.23 - perplexity -1.26
2023-01-28 20:21:55,722:INFO: Building model...
2023-01-28 20:21:55,973:WARNING: From Z:\FYP\im2smilesv2\model\decoder.py:58: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
2023-01-28 20:21:56,003:WARNING: From C:\Users\Yuriy\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\keras\layers\legacy_rnn\rnn_cell_impl.py:991: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2023-01-28 20:21:56,152:WARNING: From Z:\FYP\im2smilesv2\model\components\dynamic_decode.py:58: calling while_loop_v2 (from tensorflow.python.ops.control_flow_ops) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.while_loop(c, b, vars, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.while_loop(c, b, vars))
2023-01-28 20:21:59,901:INFO: - done.
2023-01-28 20:21:59,902:INFO: Epoch 1/30
2023-01-28 20:24:24,553:INFO: - Training:  - 144s - loss: 1.0859 - perplexity: 3.0015 - lr: 0.0001
2023-01-28 20:24:39,426:INFO: - Eval: BLEU-4 36.79 - EM 0.00 - Edit 61.31 - perplexity -2.45
2023-01-28 20:24:39,427:INFO: - New best score (-2.45)!
2023-01-28 20:24:40,826:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:24:40,826:INFO: - Elapsed time: 160.92, lr: 0.00010
2023-01-28 20:24:40,827:INFO: Epoch 2/30
2023-01-28 20:26:56,134:INFO: - Training:  - 135s - loss: 0.8742 - perplexity: 2.3996 - lr: 0.0001
2023-01-28 20:27:08,629:INFO: - Eval: BLEU-4 35.29 - EM 0.00 - Edit 60.87 - perplexity -2.33
2023-01-28 20:27:08,630:INFO: - New best score (-2.33)!
2023-01-28 20:27:09,940:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:27:09,941:INFO: - Elapsed time: 149.11, lr: 0.00010
2023-01-28 20:27:09,942:INFO: Epoch 3/30
2023-01-28 20:29:23,567:INFO: - Training:  - 133s - loss: 0.8096 - perplexity: 2.2492 - lr: 0.0001
2023-01-28 20:29:37,203:INFO: - Eval: BLEU-4 41.27 - EM 0.00 - Edit 62.11 - perplexity -2.08
2023-01-28 20:29:37,204:INFO: - New best score (-2.08)!
2023-01-28 20:29:38,531:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:29:38,532:INFO: - Elapsed time: 148.59, lr: 0.00010
2023-01-28 20:29:38,532:INFO: Epoch 4/30
2023-01-28 20:31:58,354:INFO: - Training:  - 139s - loss: 0.7163 - perplexity: 2.0489 - lr: 0.0001
2023-01-28 20:32:12,067:INFO: - Eval: BLEU-4 38.27 - EM 0.00 - Edit 61.89 - perplexity -2.08
2023-01-28 20:32:12,068:INFO: - New best score (-2.08)!
2023-01-28 20:32:13,301:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:32:13,301:INFO: - Elapsed time: 154.77, lr: 0.00010
2023-01-28 20:32:13,301:INFO: Epoch 5/30
2023-01-28 20:34:32,154:INFO: - Training:  - 138s - loss: 0.6425 - perplexity: 1.9027 - lr: 0.0001
2023-01-28 20:34:46,242:INFO: - Eval: BLEU-4 43.03 - EM 0.00 - Edit 64.58 - perplexity -1.88
2023-01-28 20:34:46,243:INFO: - New best score (-1.88)!
2023-01-28 20:34:47,664:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:34:47,664:INFO: - Elapsed time: 154.36, lr: 0.00010
2023-01-28 20:34:47,665:INFO: Epoch 6/30
2023-01-28 20:37:05,405:INFO: - Training:  - 137s - loss: 0.5876 - perplexity: 1.8011 - lr: 0.0001
2023-01-28 20:37:19,926:INFO: - Eval: BLEU-4 49.82 - EM 0.00 - Edit 65.76 - perplexity -1.78
2023-01-28 20:37:19,927:INFO: - New best score (-1.78)!
2023-01-28 20:37:21,186:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:37:21,187:INFO: - Elapsed time: 153.52, lr: 0.00010
2023-01-28 20:37:21,187:INFO: Epoch 7/30
2023-01-28 20:39:40,170:INFO: - Training:  - 138s - loss: 0.5322 - perplexity: 1.7040 - lr: 0.0001
2023-01-28 20:39:54,622:INFO: - Eval: BLEU-4 56.58 - EM 0.00 - Edit 67.10 - perplexity -1.70
2023-01-28 20:39:54,623:INFO: - New best score (-1.70)!
2023-01-28 20:39:56,005:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:39:56,006:INFO: - Elapsed time: 154.82, lr: 0.00010
2023-01-28 20:39:56,006:INFO: Epoch 8/30
2023-01-28 20:42:12,371:INFO: - Training:  - 136s - loss: 0.4835 - perplexity: 1.6231 - lr: 0.0001
2023-01-28 20:42:26,486:INFO: - Eval: BLEU-4 61.49 - EM 0.00 - Edit 68.52 - perplexity -1.68
2023-01-28 20:42:26,487:INFO: - New best score (-1.68)!
2023-01-28 20:42:27,760:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:42:27,761:INFO: - Elapsed time: 151.76, lr: 0.00010
2023-01-28 20:42:27,761:INFO: Epoch 9/30
2023-01-28 20:44:42,353:INFO: - Training:  - 134s - loss: 0.4375 - perplexity: 1.5501 - lr: 0.0001
2023-01-28 20:44:55,917:INFO: - Eval: BLEU-4 62.98 - EM 0.61 - Edit 70.59 - perplexity -1.60
2023-01-28 20:44:55,918:INFO: - New best score (-1.60)!
2023-01-28 20:44:57,200:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:44:57,201:INFO: - Elapsed time: 149.44, lr: 0.00010
2023-01-28 20:44:57,201:INFO: Epoch 10/30
2023-01-28 20:47:12,072:INFO: - Training:  - 134s - loss: 0.3932 - perplexity: 1.4827 - lr: 0.0001
2023-01-28 20:47:25,773:INFO: - Eval: BLEU-4 66.68 - EM 0.86 - Edit 71.26 - perplexity -1.56
2023-01-28 20:47:25,774:INFO: - New best score (-1.56)!
2023-01-28 20:47:27,082:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:47:27,082:INFO: - Elapsed time: 149.88, lr: 0.00010
2023-01-28 20:47:27,082:INFO: Epoch 11/30
2023-01-28 20:49:42,808:INFO: - Training:  - 135s - loss: 0.3592 - perplexity: 1.4333 - lr: 0.0001
2023-01-28 20:49:56,376:INFO: - Eval: BLEU-4 66.36 - EM 1.22 - Edit 72.33 - perplexity -1.52
2023-01-28 20:49:56,377:INFO: - New best score (-1.52)!
2023-01-28 20:49:57,662:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:49:57,664:INFO: - Elapsed time: 150.58, lr: 0.00010
2023-01-28 20:49:57,664:INFO: Epoch 12/30
2023-01-28 20:52:14,652:INFO: - Training:  - 136s - loss: 0.3231 - perplexity: 1.3824 - lr: 0.0001
2023-01-28 20:52:28,432:INFO: - Eval: BLEU-4 70.60 - EM 4.28 - Edit 74.59 - perplexity -1.41
2023-01-28 20:52:28,433:INFO: - New best score (-1.41)!
2023-01-28 20:52:29,907:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:52:29,908:INFO: - Elapsed time: 152.24, lr: 0.00010
2023-01-28 20:52:29,908:INFO: Epoch 13/30
2023-01-28 20:54:53,062:INFO: - Training:  - 143s - loss: 0.2974 - perplexity: 1.3474 - lr: 0.0001
2023-01-28 20:55:07,806:INFO: - Eval: BLEU-4 73.51 - EM 5.75 - Edit 75.45 - perplexity -1.37
2023-01-28 20:55:07,807:INFO: - New best score (-1.37)!
2023-01-28 20:55:09,203:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:55:09,203:INFO: - Elapsed time: 159.29, lr: 0.00010
2023-01-28 20:55:09,204:INFO: Epoch 14/30
2023-01-28 20:57:24,873:INFO: - Training:  - 135s - loss: 0.2773 - perplexity: 1.3207 - lr: 0.0001
2023-01-28 20:57:38,728:INFO: - Eval: BLEU-4 73.62 - EM 6.85 - Edit 76.18 - perplexity -1.35
2023-01-28 20:57:38,728:INFO: - New best score (-1.35)!
2023-01-28 20:57:40,175:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 20:57:40,175:INFO: - Elapsed time: 150.97, lr: 0.00010
2023-01-28 20:57:40,176:INFO: Epoch 15/30
2023-01-28 20:59:56,204:INFO: - Training:  - 136s - loss: 0.2513 - perplexity: 1.2865 - lr: 0.0001
2023-01-28 21:00:10,243:INFO: - Eval: BLEU-4 75.90 - EM 7.09 - Edit 77.34 - perplexity -1.36
2023-01-28 21:00:10,244:INFO: - Elapsed time: 150.07, lr: 0.00010
2023-01-28 21:00:10,244:INFO: Epoch 16/30
2023-01-28 21:02:26,320:INFO: - Training:  - 136s - loss: 0.2315 - perplexity: 1.2612 - lr: 0.0001
2023-01-28 21:02:40,116:INFO: - Eval: BLEU-4 77.18 - EM 10.88 - Edit 78.94 - perplexity -1.33
2023-01-28 21:02:40,116:INFO: - New best score (-1.33)!
2023-01-28 21:02:41,778:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:02:41,778:INFO: - Elapsed time: 151.53, lr: 0.00010
2023-01-28 21:02:41,779:INFO: Epoch 17/30
2023-01-28 21:04:59,645:INFO: - Training:  - 137s - loss: 0.2123 - perplexity: 1.2374 - lr: 0.0001
2023-01-28 21:05:13,911:INFO: - Eval: BLEU-4 78.70 - EM 16.14 - Edit 80.30 - perplexity -1.29
2023-01-28 21:05:13,911:INFO: - New best score (-1.29)!
2023-01-28 21:05:15,192:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:05:15,192:INFO: - Elapsed time: 153.41, lr: 0.00010
2023-01-28 21:05:15,193:INFO: Epoch 18/30
2023-01-28 21:07:31,654:INFO: - Training:  - 136s - loss: 0.1886 - perplexity: 1.2083 - lr: 0.0001
2023-01-28 21:07:45,722:INFO: - Eval: BLEU-4 79.44 - EM 16.63 - Edit 80.42 - perplexity -1.28
2023-01-28 21:07:45,722:INFO: - New best score (-1.28)!
2023-01-28 21:07:46,956:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:07:46,956:INFO: - Elapsed time: 151.76, lr: 0.00010
2023-01-28 21:07:46,957:INFO: Epoch 19/30
2023-01-28 21:10:01,680:INFO: - Training:  - 134s - loss: 0.1725 - perplexity: 1.1889 - lr: 0.0001
2023-01-28 21:10:16,044:INFO: - Eval: BLEU-4 80.69 - EM 18.70 - Edit 80.94 - perplexity -1.27
2023-01-28 21:10:16,044:INFO: - New best score (-1.27)!
2023-01-28 21:10:17,319:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:10:17,320:INFO: - Elapsed time: 150.36, lr: 0.00010
2023-01-28 21:10:17,320:INFO: Epoch 20/30
2023-01-28 21:12:32,992:INFO: - Training:  - 135s - loss: 0.1594 - perplexity: 1.1733 - lr: 0.0001
2023-01-28 21:12:47,121:INFO: - Eval: BLEU-4 80.92 - EM 17.60 - Edit 81.29 - perplexity -1.27
2023-01-28 21:12:47,122:INFO: - New best score (-1.27)!
2023-01-28 21:12:48,345:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:12:48,346:INFO: - Elapsed time: 151.03, lr: 0.00010
2023-01-28 21:12:48,346:INFO: Epoch 21/30
2023-01-28 21:15:02,894:INFO: - Training:  - 134s - loss: 0.1492 - perplexity: 1.1614 - lr: 0.0001
2023-01-28 21:15:17,001:INFO: - Eval: BLEU-4 80.22 - EM 16.14 - Edit 81.09 - perplexity -1.30
2023-01-28 21:15:17,002:INFO: - Elapsed time: 148.66, lr: 0.00010
2023-01-28 21:15:17,002:INFO: Epoch 22/30
2023-01-28 21:17:33,340:INFO: - Training:  - 136s - loss: 0.1421 - perplexity: 1.1532 - lr: 0.0001
2023-01-28 21:17:47,635:INFO: - Eval: BLEU-4 78.97 - EM 12.22 - Edit 80.37 - perplexity -1.35
2023-01-28 21:17:47,636:INFO: - Elapsed time: 150.63, lr: 0.00010
2023-01-28 21:17:47,636:INFO: Epoch 23/30
2023-01-28 21:20:05,888:INFO: - Training:  - 138s - loss: 0.1331 - perplexity: 1.1429 - lr: 0.0001
2023-01-28 21:20:20,164:INFO: - Eval: BLEU-4 81.94 - EM 18.70 - Edit 81.84 - perplexity -1.29
2023-01-28 21:20:20,165:INFO: - Elapsed time: 152.53, lr: 0.00010
2023-01-28 21:20:20,165:INFO: Epoch 24/30
2023-01-28 21:22:36,846:INFO: - Training:  - 136s - loss: 0.1201 - perplexity: 1.1280 - lr: 0.0001
2023-01-28 21:22:51,454:INFO: - Eval: BLEU-4 82.22 - EM 22.13 - Edit 82.09 - perplexity -1.26
2023-01-28 21:22:51,454:INFO: - New best score (-1.26)!
2023-01-28 21:22:53,782:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:22:53,782:INFO: - Elapsed time: 153.62, lr: 0.00010
2023-01-28 21:22:53,783:INFO: Epoch 25/30
2023-01-28 21:25:10,820:INFO: - Training:  - 137s - loss: 0.1117 - perplexity: 1.1186 - lr: 0.0001
2023-01-28 21:25:25,914:INFO: - Eval: BLEU-4 81.08 - EM 20.90 - Edit 81.61 - perplexity -1.26
2023-01-28 21:25:25,915:INFO: - Elapsed time: 152.13, lr: 0.00010
2023-01-28 21:25:25,915:INFO: Epoch 26/30
2023-01-28 21:27:43,846:INFO: - Training:  - 137s - loss: 0.1059 - perplexity: 1.1122 - lr: 0.0001
2023-01-28 21:27:58,108:INFO: - Eval: BLEU-4 84.36 - EM 27.38 - Edit 83.75 - perplexity -1.24
2023-01-28 21:27:58,109:INFO: - New best score (-1.24)!
2023-01-28 21:28:00,474:INFO: - Saved model in results/clean-RDKit-10K/model.weights/
2023-01-28 21:28:00,475:INFO: - Elapsed time: 154.56, lr: 0.00010
2023-01-28 21:28:00,475:INFO: Epoch 27/30
2023-01-28 21:30:16,724:INFO: - Training:  - 136s - loss: 0.0957 - perplexity: 1.1009 - lr: 0.0001
2023-01-28 21:30:31,482:INFO: - Eval: BLEU-4 83.77 - EM 23.11 - Edit 83.54 - perplexity -1.26
2023-01-28 21:30:31,483:INFO: - Elapsed time: 151.01, lr: 0.00010
2023-01-28 21:30:31,483:INFO: Epoch 28/30
2023-01-28 21:32:51,367:INFO: - Training:  - 139s - loss: 0.0853 - perplexity: 1.0895 - lr: 0.0001
2023-01-28 21:33:05,656:INFO: - Eval: BLEU-4 83.34 - EM 26.16 - Edit 83.73 - perplexity -1.26
2023-01-28 21:33:05,657:INFO: - Elapsed time: 154.17, lr: 0.00010
2023-01-28 21:33:05,658:INFO: Epoch 29/30
2023-01-28 21:35:24,437:INFO: - Training:  - 138s - loss: 0.0730 - perplexity: 1.0760 - lr: 0.0001
2023-01-28 21:35:38,989:INFO: - Eval: BLEU-4 84.93 - EM 25.18 - Edit 84.26 - perplexity -1.26
2023-01-28 21:35:38,990:INFO: - Elapsed time: 153.33, lr: 0.00010
2023-01-28 21:35:38,990:INFO: Epoch 30/30
2023-01-28 21:37:54,698:INFO: - Training:  - 135s - loss: 0.0645 - perplexity: 1.0668 - lr: 0.0001
2023-01-28 21:38:09,078:INFO: - Eval: BLEU-4 84.04 - EM 26.65 - Edit 83.48 - perplexity -1.26
2023-01-28 21:38:09,079:INFO: - Elapsed time: 150.09, lr: 0.00010
2023-01-28 22:08:50,884:INFO: Building model...
2023-01-28 22:08:51,136:WARNING: From Z:\FYP\im2smilesv2\model\decoder.py:58: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
2023-01-28 22:08:51,169:WARNING: From C:\Users\Yuriy\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\keras\layers\legacy_rnn\rnn_cell_impl.py:991: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2023-01-28 22:08:51,463:WARNING: From Z:\FYP\im2smilesv2\model\components\dynamic_decode.py:58: calling while_loop_v2 (from tensorflow.python.ops.control_flow_ops) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.while_loop(c, b, vars, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.while_loop(c, b, vars))
2023-01-28 22:08:53,066:INFO: - done.
2023-01-28 22:08:53,067:INFO: Reloading the latest trained model...
2023-01-28 22:08:53,069:INFO: Restoring parameters from results/clean-RDKit-10K/model.weights/
2023-01-28 22:09:13,283:INFO: - Test Txt: BLEU-4 83.96 - EM 26.97 - Edit 83.41 - perplexity -1.24
2023-01-28 23:03:48,625:INFO: Building model...
2023-01-28 23:03:52,876:INFO: - done.
2023-01-28 23:03:52,878:INFO: Epoch 1/30
2023-01-28 23:17:42,375:INFO: - Training:  - 829s - loss: 0.8653 - perplexity: 2.4095 - lr: 0.0001
2023-01-28 23:18:56,267:INFO: - Eval: BLEU-4 41.88 - EM 0.00 - Edit 62.19 - perplexity -1.93
2023-01-28 23:18:56,268:INFO: - New best score (-1.93)!
2023-01-28 23:18:57,619:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-28 23:18:57,619:INFO: - Elapsed time: 904.74, lr: 0.00010
2023-01-28 23:18:57,620:INFO: Epoch 2/30
2023-01-28 23:30:17,724:INFO: - Training:  - 680s - loss: 0.5528 - perplexity: 1.7428 - lr: 0.0001
2023-01-28 23:31:27,813:INFO: - Eval: BLEU-4 58.31 - EM 0.32 - Edit 68.04 - perplexity -1.64
2023-01-28 23:31:27,813:INFO: - New best score (-1.64)!
2023-01-28 23:31:29,014:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-28 23:31:29,015:INFO: - Elapsed time: 751.39, lr: 0.00010
2023-01-28 23:31:29,015:INFO: Epoch 3/30
2023-01-28 23:42:50,583:INFO: - Training:  - 681s - loss: 0.3552 - perplexity: 1.4289 - lr: 0.0001
2023-01-28 23:44:01,853:INFO: - Eval: BLEU-4 73.31 - EM 8.34 - Edit 76.56 - perplexity -1.32
2023-01-28 23:44:01,854:INFO: - New best score (-1.32)!
2023-01-28 23:44:03,058:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-28 23:44:03,058:INFO: - Elapsed time: 754.04, lr: 0.00010
2023-01-28 23:44:03,059:INFO: Epoch 4/30
2023-01-28 23:55:24,420:INFO: - Training:  - 681s - loss: 0.2335 - perplexity: 1.2641 - lr: 0.0001
2023-01-28 23:56:37,434:INFO: - Eval: BLEU-4 80.22 - EM 21.19 - Edit 81.48 - perplexity -1.23
2023-01-28 23:56:37,435:INFO: - New best score (-1.23)!
2023-01-28 23:56:38,639:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-28 23:56:38,640:INFO: - Elapsed time: 755.58, lr: 0.00010
2023-01-28 23:56:38,640:INFO: Epoch 5/30
2023-01-29 00:08:02,806:INFO: - Training:  - 684s - loss: 0.1706 - perplexity: 1.1868 - lr: 0.0001
2023-01-29 00:09:16,199:INFO: - Eval: BLEU-4 84.09 - EM 28.45 - Edit 84.83 - perplexity -1.19
2023-01-29 00:09:16,200:INFO: - New best score (-1.19)!
2023-01-29 00:09:17,512:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 00:09:17,513:INFO: - Elapsed time: 758.87, lr: 0.00010
2023-01-29 00:09:17,513:INFO: Epoch 6/30
2023-01-29 00:20:40,852:INFO: - Training:  - 683s - loss: 0.1307 - perplexity: 1.1402 - lr: 0.0001
2023-01-29 00:21:53,958:INFO: - Eval: BLEU-4 88.05 - EM 45.11 - Edit 88.13 - perplexity -1.13
2023-01-29 00:21:53,959:INFO: - New best score (-1.13)!
2023-01-29 00:21:55,169:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 00:21:55,170:INFO: - Elapsed time: 757.66, lr: 0.00010
2023-01-29 00:21:55,170:INFO: Epoch 7/30
2023-01-29 00:33:18,040:INFO: - Training:  - 682s - loss: 0.1021 - perplexity: 1.1080 - lr: 0.0001
2023-01-29 00:34:30,299:INFO: - Eval: BLEU-4 89.95 - EM 50.56 - Edit 89.78 - perplexity -1.11
2023-01-29 00:34:30,300:INFO: - New best score (-1.11)!
2023-01-29 00:34:32,240:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 00:34:32,240:INFO: - Elapsed time: 757.07, lr: 0.00010
2023-01-29 00:34:32,241:INFO: Epoch 8/30
2023-01-29 00:45:55,110:INFO: - Training:  - 682s - loss: 0.0826 - perplexity: 1.0865 - lr: 0.0001
2023-01-29 00:47:08,496:INFO: - Eval: BLEU-4 91.43 - EM 55.76 - Edit 91.03 - perplexity -1.10
2023-01-29 00:47:08,497:INFO: - New best score (-1.10)!
2023-01-29 00:47:09,627:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 00:47:09,628:INFO: - Elapsed time: 757.39, lr: 0.00010
2023-01-29 00:47:09,628:INFO: Epoch 9/30
2023-01-29 00:58:39,547:INFO: - Training:  - 689s - loss: 0.0672 - perplexity: 1.0698 - lr: 0.0001
2023-01-29 00:59:52,090:INFO: - Eval: BLEU-4 91.37 - EM 59.20 - Edit 91.50 - perplexity -1.09
2023-01-29 00:59:52,091:INFO: - New best score (-1.09)!
2023-01-29 00:59:53,751:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 00:59:53,752:INFO: - Elapsed time: 764.12, lr: 0.00010
2023-01-29 00:59:53,752:INFO: Epoch 10/30
2023-01-29 01:11:23,445:INFO: - Training:  - 689s - loss: 0.0553 - perplexity: 1.0571 - lr: 0.0001
2023-01-29 01:12:35,131:INFO: - Eval: BLEU-4 91.34 - EM 59.79 - Edit 91.86 - perplexity -1.09
2023-01-29 01:12:35,132:INFO: - Elapsed time: 761.38, lr: 0.00010
2023-01-29 01:12:35,133:INFO: Epoch 11/30
2023-01-29 01:24:02,235:INFO: - Training:  - 687s - loss: 0.0468 - perplexity: 1.0481 - lr: 0.0001
2023-01-29 01:25:15,567:INFO: - Eval: BLEU-4 93.26 - EM 69.42 - Edit 93.27 - perplexity -1.07
2023-01-29 01:25:15,568:INFO: - New best score (-1.07)!
2023-01-29 01:25:16,772:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 01:25:16,773:INFO: - Elapsed time: 761.64, lr: 0.00010
2023-01-29 01:25:16,774:INFO: Epoch 12/30
2023-01-29 01:36:44,092:INFO: - Training:  - 687s - loss: 0.0411 - perplexity: 1.0422 - lr: 0.0001
2023-01-29 01:37:58,150:INFO: - Eval: BLEU-4 94.72 - EM 74.37 - Edit 94.27 - perplexity -1.06
2023-01-29 01:37:58,151:INFO: - New best score (-1.06)!
2023-01-29 01:37:59,330:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 01:37:59,331:INFO: - Elapsed time: 762.56, lr: 0.00010
2023-01-29 01:37:59,332:INFO: Epoch 13/30
2023-01-29 01:49:25,176:INFO: - Training:  - 685s - loss: 0.0366 - perplexity: 1.0375 - lr: 0.0001
2023-01-29 01:50:40,590:INFO: - Eval: BLEU-4 94.90 - EM 73.41 - Edit 94.27 - perplexity -1.06
2023-01-29 01:50:40,590:INFO: - Elapsed time: 761.26, lr: 0.00010
2023-01-29 01:50:40,591:INFO: Epoch 14/30
2023-01-29 02:02:06,023:INFO: - Training:  - 685s - loss: 0.0295 - perplexity: 1.0301 - lr: 0.0001
2023-01-29 02:03:21,628:INFO: - Eval: BLEU-4 95.71 - EM 78.11 - Edit 95.11 - perplexity -1.05
2023-01-29 02:03:21,629:INFO: - New best score (-1.05)!
2023-01-29 02:03:22,901:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 02:03:22,902:INFO: - Elapsed time: 762.31, lr: 0.00010
2023-01-29 02:03:22,902:INFO: Epoch 15/30
2023-01-29 02:14:49,031:INFO: - Training:  - 686s - loss: 0.0280 - perplexity: 1.0285 - lr: 0.0001
2023-01-29 02:16:03,841:INFO: - Eval: BLEU-4 95.24 - EM 76.31 - Edit 94.67 - perplexity -1.06
2023-01-29 02:16:03,842:INFO: - Elapsed time: 760.94, lr: 0.00010
2023-01-29 02:16:03,843:INFO: Epoch 16/30
2023-01-29 02:27:31,061:INFO: - Training:  - 687s - loss: 0.0269 - perplexity: 1.0274 - lr: 0.0001
2023-01-29 02:28:45,528:INFO: - Eval: BLEU-4 95.67 - EM 78.51 - Edit 95.18 - perplexity -1.05
2023-01-29 02:28:45,528:INFO: - New best score (-1.05)!
2023-01-29 02:28:46,744:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 02:28:46,745:INFO: - Elapsed time: 762.90, lr: 0.00010
2023-01-29 02:28:46,746:INFO: Epoch 17/30
2023-01-29 02:40:22,361:INFO: - Training:  - 695s - loss: 0.0214 - perplexity: 1.0217 - lr: 0.0001
2023-01-29 02:41:39,353:INFO: - Eval: BLEU-4 94.58 - EM 74.40 - Edit 94.12 - perplexity -1.06
2023-01-29 02:41:39,353:INFO: - Elapsed time: 772.61, lr: 0.00010
2023-01-29 02:41:39,354:INFO: Epoch 18/30
2023-01-29 02:53:19,422:INFO: - Training:  - 700s - loss: 0.0194 - perplexity: 1.0197 - lr: 0.0001
2023-01-29 02:54:37,432:INFO: - Eval: BLEU-4 96.17 - EM 80.47 - Edit 95.54 - perplexity -1.05
2023-01-29 02:54:37,433:INFO: - New best score (-1.05)!
2023-01-29 02:54:38,579:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 02:54:38,579:INFO: - Elapsed time: 779.22, lr: 0.00010
2023-01-29 02:54:38,580:INFO: Epoch 19/30
2023-01-29 03:07:54,598:INFO: - Training:  - 796s - loss: 0.0195 - perplexity: 1.0198 - lr: 0.0001
2023-01-29 03:10:33,338:INFO: - Eval: BLEU-4 95.42 - EM 76.80 - Edit 94.67 - perplexity -1.06
2023-01-29 03:10:33,339:INFO: - Elapsed time: 954.76, lr: 0.00010
2023-01-29 03:10:33,339:INFO: Epoch 20/30
2023-01-29 03:27:41,607:INFO: - Training:  - 1028s - loss: 0.0168 - perplexity: 1.0170 - lr: 0.0001
2023-01-29 03:30:13,623:INFO: - Eval: BLEU-4 95.82 - EM 78.98 - Edit 95.31 - perplexity -1.05
2023-01-29 03:30:13,623:INFO: - Elapsed time: 1180.28, lr: 0.00010
2023-01-29 03:30:13,624:INFO: Epoch 21/30
2023-01-29 03:47:10,012:INFO: - Training:  - 1016s - loss: 0.0155 - perplexity: 1.0157 - lr: 0.0001
2023-01-29 03:49:32,574:INFO: - Eval: BLEU-4 94.09 - EM 73.88 - Edit 94.11 - perplexity -1.06
2023-01-29 03:49:32,575:INFO: - Elapsed time: 1158.95, lr: 0.00010
2023-01-29 03:49:32,575:INFO: Epoch 22/30
2023-01-29 04:06:30,355:INFO: - Training:  - 1017s - loss: 0.0141 - perplexity: 1.0142 - lr: 0.0001
2023-01-29 04:09:05,615:INFO: - Eval: BLEU-4 95.14 - EM 77.64 - Edit 94.78 - perplexity -1.05
2023-01-29 04:09:05,616:INFO: - Elapsed time: 1173.04, lr: 0.00010
2023-01-29 04:09:05,616:INFO: Epoch 23/30
2023-01-29 04:25:59,230:INFO: - Training:  - 1013s - loss: 0.0137 - perplexity: 1.0138 - lr: 0.0001
2023-01-29 04:28:28,943:INFO: - Eval: BLEU-4 95.74 - EM 80.19 - Edit 95.38 - perplexity -1.05
2023-01-29 04:28:28,943:INFO: - Elapsed time: 1163.33, lr: 0.00010
2023-01-29 04:28:28,944:INFO: Epoch 24/30
2023-01-29 04:45:29,073:INFO: - Training:  - 1020s - loss: 0.0142 - perplexity: 1.0144 - lr: 0.0001
2023-01-29 04:47:59,297:INFO: - Eval: BLEU-4 96.89 - EM 84.97 - Edit 96.46 - perplexity -1.03
2023-01-29 04:47:59,298:INFO: - New best score (-1.03)!
2023-01-29 04:48:00,757:INFO: - Saved model in results/clean-RDKit-50K/model.weights/
2023-01-29 04:48:00,758:INFO: - Elapsed time: 1171.81, lr: 0.00010
2023-01-29 04:48:00,758:INFO: Epoch 25/30
2023-01-29 05:04:55,371:INFO: - Training:  - 1014s - loss: 0.0114 - perplexity: 1.0115 - lr: 0.0001
2023-01-29 05:07:24,735:INFO: - Eval: BLEU-4 96.45 - EM 82.40 - Edit 96.02 - perplexity -1.04
2023-01-29 05:07:24,736:INFO: - Elapsed time: 1163.98, lr: 0.00010
2023-01-29 05:07:24,737:INFO: Epoch 26/30
2023-01-29 05:24:26,483:INFO: - Training:  - 1021s - loss: 0.0098 - perplexity: 1.0099 - lr: 0.0001
2023-01-29 05:26:56,808:INFO: - Eval: BLEU-4 96.76 - EM 84.45 - Edit 96.29 - perplexity -1.04
2023-01-29 05:26:56,809:INFO: - Elapsed time: 1172.07, lr: 0.00010
2023-01-29 05:26:56,809:INFO: Epoch 27/30
2023-01-29 05:44:00,129:INFO: - Training:  - 1023s - loss: 0.0104 - perplexity: 1.0105 - lr: 0.0001
2023-01-29 05:46:33,477:INFO: - Eval: BLEU-4 96.66 - EM 84.23 - Edit 96.25 - perplexity -1.04
2023-01-29 05:46:33,477:INFO: - Elapsed time: 1176.67, lr: 0.00010
2023-01-29 05:46:33,478:INFO: Epoch 28/30
2023-01-29 06:03:28,081:INFO: - Training:  - 1014s - loss: 0.0097 - perplexity: 1.0098 - lr: 0.0001
2023-01-29 06:05:51,263:INFO: - Eval: BLEU-4 96.16 - EM 81.75 - Edit 95.83 - perplexity -1.04
2023-01-29 06:05:51,264:INFO: - Elapsed time: 1157.79, lr: 0.00010
2023-01-29 06:05:51,264:INFO: Epoch 29/30
2023-01-29 06:22:49,746:INFO: - Training:  - 1018s - loss: 0.0092 - perplexity: 1.0093 - lr: 0.0001
2023-01-29 06:25:19,273:INFO: - Eval: BLEU-4 96.67 - EM 84.45 - Edit 96.46 - perplexity -1.04
2023-01-29 06:25:19,273:INFO: - Elapsed time: 1168.01, lr: 0.00010
2023-01-29 06:25:19,274:INFO: Epoch 30/30
2023-01-29 06:42:10,323:INFO: - Training:  - 1011s - loss: 0.0089 - perplexity: 1.0090 - lr: 0.0001
2023-01-29 06:44:40,849:INFO: - Eval: BLEU-4 97.03 - EM 85.54 - Edit 96.62 - perplexity -1.03
2023-01-29 06:44:40,850:INFO: - Elapsed time: 1161.58, lr: 0.00010
2023-01-29 16:11:57,381:INFO: Building model...
2023-01-29 16:12:00,260:INFO: - done.
2023-01-29 16:12:00,261:INFO: Reloading the latest trained model...
2023-01-29 16:12:00,262:INFO: Restoring parameters from results/clean-RDKit-50K/model.weights/
2023-01-29 16:13:21,749:INFO: - Test Txt: BLEU-4 96.93 - EM 84.96 - Edit 96.56 - perplexity -1.04
2023-01-29 16:18:57,009:INFO: Building model...
2023-01-29 16:19:00,109:INFO: - done.
2023-01-29 16:19:00,111:INFO: Epoch 1/30
2023-01-29 16:41:56,252:INFO: - Training:  - 1376s - loss: 0.6618 - perplexity: 1.9951 - lr: 0.0001
2023-01-29 16:44:29,719:INFO: - Eval: BLEU-4 64.34 - EM 1.55 - Edit 71.41 - perplexity -1.48
2023-01-29 16:44:29,720:INFO: - New best score (-1.48)!
2023-01-29 16:44:31,030:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 16:44:31,031:INFO: - Elapsed time: 1530.92, lr: 0.00010
2023-01-29 16:44:31,032:INFO: Epoch 2/30
2023-01-29 17:07:31,075:INFO: - Training:  - 1380s - loss: 0.2543 - perplexity: 1.2927 - lr: 0.0001
2023-01-29 17:09:56,117:INFO: - Eval: BLEU-4 82.32 - EM 26.30 - Edit 83.69 - perplexity -1.20
2023-01-29 17:09:56,118:INFO: - New best score (-1.20)!
2023-01-29 17:09:57,378:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 17:09:57,379:INFO: - Elapsed time: 1526.35, lr: 0.00010
2023-01-29 17:09:57,379:INFO: Epoch 3/30
2023-01-29 17:32:56,384:INFO: - Training:  - 1379s - loss: 0.1305 - perplexity: 1.1403 - lr: 0.0001
2023-01-29 17:35:21,140:INFO: - Eval: BLEU-4 89.26 - EM 53.15 - Edit 89.92 - perplexity -1.11
2023-01-29 17:35:21,141:INFO: - New best score (-1.11)!
2023-01-29 17:35:22,442:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 17:35:22,443:INFO: - Elapsed time: 1525.06, lr: 0.00010
2023-01-29 17:35:22,444:INFO: Epoch 4/30
2023-01-29 17:58:20,939:INFO: - Training:  - 1378s - loss: 0.0812 - perplexity: 1.0851 - lr: 0.0001
2023-01-29 18:00:49,044:INFO: - Eval: BLEU-4 92.19 - EM 62.39 - Edit 92.06 - perplexity -1.08
2023-01-29 18:00:49,045:INFO: - New best score (-1.08)!
2023-01-29 18:00:50,277:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 18:00:50,278:INFO: - Elapsed time: 1527.83, lr: 0.00010
2023-01-29 18:00:50,278:INFO: Epoch 5/30
2023-01-29 18:23:52,681:INFO: - Training:  - 1382s - loss: 0.0566 - perplexity: 1.0585 - lr: 0.0001
2023-01-29 18:26:21,061:INFO: - Eval: BLEU-4 93.64 - EM 70.46 - Edit 93.60 - perplexity -1.06
2023-01-29 18:26:21,062:INFO: - New best score (-1.06)!
2023-01-29 18:26:22,359:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 18:26:22,369:INFO: - Elapsed time: 1532.09, lr: 0.00010
2023-01-29 18:26:22,370:INFO: Epoch 6/30
2023-01-29 18:49:23,845:INFO: - Training:  - 1381s - loss: 0.0425 - perplexity: 1.0437 - lr: 0.0001
2023-01-29 18:51:55,706:INFO: - Eval: BLEU-4 94.95 - EM 75.25 - Edit 94.48 - perplexity -1.05
2023-01-29 18:51:55,707:INFO: - New best score (-1.05)!
2023-01-29 18:51:56,934:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 18:51:56,935:INFO: - Elapsed time: 1534.56, lr: 0.00010
2023-01-29 18:51:56,935:INFO: Epoch 7/30
2023-01-29 19:14:51,394:INFO: - Training:  - 1374s - loss: 0.0344 - perplexity: 1.0352 - lr: 0.0001
2023-01-29 19:17:20,100:INFO: - Eval: BLEU-4 95.57 - EM 79.80 - Edit 95.42 - perplexity -1.04
2023-01-29 19:17:20,101:INFO: - New best score (-1.04)!
2023-01-29 19:17:21,352:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 19:17:21,352:INFO: - Elapsed time: 1524.42, lr: 0.00010
2023-01-29 19:17:21,353:INFO: Epoch 8/30
2023-01-29 19:40:09,440:INFO: - Training:  - 1368s - loss: 0.0282 - perplexity: 1.0287 - lr: 0.0001
2023-01-29 19:42:40,385:INFO: - Eval: BLEU-4 96.69 - EM 83.10 - Edit 96.35 - perplexity -1.04
2023-01-29 19:42:40,385:INFO: - New best score (-1.04)!
2023-01-29 19:42:41,893:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 19:42:41,894:INFO: - Elapsed time: 1520.54, lr: 0.00010
2023-01-29 19:42:41,895:INFO: Epoch 9/30
2023-01-29 20:05:34,364:INFO: - Training:  - 1372s - loss: 0.0238 - perplexity: 1.0243 - lr: 0.0001
2023-01-29 20:08:05,802:INFO: - Eval: BLEU-4 96.54 - EM 83.49 - Edit 96.08 - perplexity -1.03
2023-01-29 20:08:05,803:INFO: - New best score (-1.03)!
2023-01-29 20:08:06,999:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 20:08:07,000:INFO: - Elapsed time: 1525.10, lr: 0.00010
2023-01-29 20:08:07,001:INFO: Epoch 10/30
2023-01-29 20:30:58,113:INFO: - Training:  - 1371s - loss: 0.0209 - perplexity: 1.0212 - lr: 0.0001
2023-01-29 20:33:32,662:INFO: - Eval: BLEU-4 96.22 - EM 81.97 - Edit 96.07 - perplexity -1.03
2023-01-29 20:33:32,663:INFO: - Elapsed time: 1525.66, lr: 0.00010
2023-01-29 20:33:32,663:INFO: Epoch 11/30
2023-01-29 20:56:23,398:INFO: - Training:  - 1370s - loss: 0.0184 - perplexity: 1.0187 - lr: 0.0001
2023-01-29 20:58:53,393:INFO: - Eval: BLEU-4 97.41 - EM 87.67 - Edit 97.11 - perplexity -1.02
2023-01-29 20:58:53,394:INFO: - New best score (-1.02)!
2023-01-29 20:58:54,694:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 20:58:54,694:INFO: - Elapsed time: 1522.03, lr: 0.00010
2023-01-29 20:58:54,695:INFO: Epoch 12/30
2023-01-29 21:21:44,689:INFO: - Training:  - 1369s - loss: 0.0158 - perplexity: 1.0160 - lr: 0.0001
2023-01-29 21:24:14,202:INFO: - Eval: BLEU-4 94.76 - EM 74.48 - Edit 94.43 - perplexity -1.05
2023-01-29 21:24:14,203:INFO: - Elapsed time: 1519.51, lr: 0.00010
2023-01-29 21:24:14,204:INFO: Epoch 13/30
2023-01-29 21:47:02,540:INFO: - Training:  - 1368s - loss: 0.0143 - perplexity: 1.0145 - lr: 0.0001
2023-01-29 21:49:34,773:INFO: - Eval: BLEU-4 97.27 - EM 87.03 - Edit 96.93 - perplexity -1.03
2023-01-29 21:49:34,774:INFO: - Elapsed time: 1520.57, lr: 0.00010
2023-01-29 21:49:34,775:INFO: Epoch 14/30
2023-01-29 22:12:25,825:INFO: - Training:  - 1371s - loss: 0.0135 - perplexity: 1.0136 - lr: 0.0001
2023-01-29 22:14:58,476:INFO: - Eval: BLEU-4 97.03 - EM 85.49 - Edit 96.60 - perplexity -1.03
2023-01-29 22:14:58,477:INFO: - Elapsed time: 1523.70, lr: 0.00010
2023-01-29 22:14:58,478:INFO: Epoch 15/30
2023-01-29 22:38:07,788:INFO: - Training:  - 1389s - loss: 0.0119 - perplexity: 1.0121 - lr: 0.0001
2023-01-29 22:40:40,704:INFO: - Eval: BLEU-4 97.34 - EM 88.20 - Edit 97.14 - perplexity -1.02
2023-01-29 22:40:40,705:INFO: - New best score (-1.02)!
2023-01-29 22:40:42,204:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 22:40:42,205:INFO: - Elapsed time: 1543.73, lr: 0.00010
2023-01-29 22:40:42,206:INFO: Epoch 16/30
2023-01-29 23:03:33,074:INFO: - Training:  - 1370s - loss: 0.0112 - perplexity: 1.0114 - lr: 0.0001
2023-01-29 23:06:12,319:INFO: - Eval: BLEU-4 95.64 - EM 82.54 - Edit 95.64 - perplexity -1.04
2023-01-29 23:06:12,320:INFO: - Elapsed time: 1530.11, lr: 0.00010
2023-01-29 23:06:12,321:INFO: Epoch 17/30
2023-01-29 23:29:11,457:INFO: - Training:  - 1379s - loss: 0.0106 - perplexity: 1.0107 - lr: 0.0001
2023-01-29 23:33:08,145:INFO: - Eval: BLEU-4 97.80 - EM 88.94 - Edit 97.44 - perplexity -1.02
2023-01-29 23:33:08,146:INFO: - New best score (-1.02)!
2023-01-29 23:33:09,348:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-29 23:33:09,349:INFO: - Elapsed time: 1617.03, lr: 0.00010
2023-01-29 23:33:09,349:INFO: Epoch 18/30
2023-01-30 00:05:04,693:INFO: - Training:  - 1915s - loss: 0.0098 - perplexity: 1.0099 - lr: 0.0001
2023-01-30 00:07:36,104:INFO: - Eval: BLEU-4 97.61 - EM 88.93 - Edit 97.35 - perplexity -1.02
2023-01-30 00:07:36,105:INFO: - New best score (-1.02)!
2023-01-30 00:07:37,403:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 00:07:37,404:INFO: - Elapsed time: 2068.05, lr: 0.00010
2023-01-30 00:07:37,404:INFO: Epoch 19/30
2023-01-30 00:30:34,300:INFO: - Training:  - 1376s - loss: 0.0083 - perplexity: 1.0084 - lr: 0.0001
2023-01-30 00:33:06,611:INFO: - Eval: BLEU-4 98.06 - EM 90.49 - Edit 97.71 - perplexity -1.02
2023-01-30 00:33:06,612:INFO: - New best score (-1.02)!
2023-01-30 00:33:07,925:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 00:33:07,925:INFO: - Elapsed time: 1530.52, lr: 0.00010
2023-01-30 00:33:07,926:INFO: Epoch 20/30
2023-01-30 00:56:05,786:INFO: - Training:  - 1377s - loss: 0.0087 - perplexity: 1.0088 - lr: 0.0001
2023-01-30 00:58:37,882:INFO: - Eval: BLEU-4 98.11 - EM 91.16 - Edit 97.79 - perplexity -1.02
2023-01-30 00:58:37,883:INFO: - New best score (-1.02)!
2023-01-30 00:58:39,274:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 00:58:39,275:INFO: - Elapsed time: 1531.35, lr: 0.00010
2023-01-30 00:58:39,275:INFO: Epoch 21/30
2023-01-30 01:21:52,801:INFO: - Training:  - 1393s - loss: 0.0091 - perplexity: 1.0092 - lr: 0.0001
2023-01-30 01:24:24,619:INFO: - Eval: BLEU-4 98.15 - EM 91.35 - Edit 97.88 - perplexity -1.02
2023-01-30 01:24:24,620:INFO: - Elapsed time: 1545.34, lr: 0.00010
2023-01-30 01:24:24,621:INFO: Epoch 22/30
2023-01-30 01:47:22,554:INFO: - Training:  - 1377s - loss: 0.0090 - perplexity: 1.0091 - lr: 0.0001
2023-01-30 01:49:58,142:INFO: - Eval: BLEU-4 97.62 - EM 89.24 - Edit 97.34 - perplexity -1.02
2023-01-30 01:49:58,143:INFO: - Elapsed time: 1533.52, lr: 0.00010
2023-01-30 01:49:58,144:INFO: Epoch 23/30
2023-01-30 02:12:58,284:INFO: - Training:  - 1380s - loss: 0.0071 - perplexity: 1.0071 - lr: 0.0001
2023-01-30 02:15:32,641:INFO: - Eval: BLEU-4 97.17 - EM 87.37 - Edit 96.78 - perplexity -1.03
2023-01-30 02:15:32,642:INFO: - Elapsed time: 1534.50, lr: 0.00010
2023-01-30 02:15:32,643:INFO: Epoch 24/30
2023-01-30 02:40:56,772:INFO: - Training:  - 1524s - loss: 0.0068 - perplexity: 1.0068 - lr: 0.0001
2023-01-30 02:43:34,332:INFO: - Eval: BLEU-4 98.19 - EM 91.71 - Edit 97.88 - perplexity -1.02
2023-01-30 02:43:34,333:INFO: - New best score (-1.02)!
2023-01-30 02:43:35,661:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 02:43:35,662:INFO: - Elapsed time: 1683.02, lr: 0.00010
2023-01-30 02:43:35,662:INFO: Epoch 25/30
2023-01-30 03:06:46,151:INFO: - Training:  - 1390s - loss: 0.0074 - perplexity: 1.0075 - lr: 0.0001
2023-01-30 03:09:17,481:INFO: - Eval: BLEU-4 97.54 - EM 89.44 - Edit 97.29 - perplexity -1.02
2023-01-30 03:09:17,483:INFO: - Elapsed time: 1541.82, lr: 0.00010
2023-01-30 03:09:17,483:INFO: Epoch 26/30
2023-01-30 03:32:14,988:INFO: - Training:  - 1377s - loss: 0.0067 - perplexity: 1.0068 - lr: 0.0001
2023-01-30 03:34:50,133:INFO: - Eval: BLEU-4 98.30 - EM 91.91 - Edit 98.02 - perplexity -1.02
2023-01-30 03:34:50,134:INFO: - New best score (-1.02)!
2023-01-30 03:34:51,891:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 03:34:51,891:INFO: - Elapsed time: 1534.41, lr: 0.00010
2023-01-30 03:34:51,892:INFO: Epoch 27/30
2023-01-30 03:57:48,697:INFO: - Training:  - 1376s - loss: 0.0057 - perplexity: 1.0057 - lr: 0.0001
2023-01-30 04:00:17,504:INFO: - Eval: BLEU-4 98.23 - EM 92.08 - Edit 98.05 - perplexity -1.02
2023-01-30 04:00:17,505:INFO: - Elapsed time: 1525.61, lr: 0.00010
2023-01-30 04:00:17,505:INFO: Epoch 28/30
2023-01-30 04:23:16,273:INFO: - Training:  - 1378s - loss: 0.0058 - perplexity: 1.0058 - lr: 0.0001
2023-01-30 04:25:49,411:INFO: - Eval: BLEU-4 98.30 - EM 92.27 - Edit 98.00 - perplexity -1.02
2023-01-30 04:25:49,412:INFO: - Elapsed time: 1531.91, lr: 0.00010
2023-01-30 04:25:49,412:INFO: Epoch 29/30
2023-01-30 04:48:50,333:INFO: - Training:  - 1380s - loss: 0.0058 - perplexity: 1.0058 - lr: 0.0001
2023-01-30 04:51:22,302:INFO: - Eval: BLEU-4 97.54 - EM 89.86 - Edit 97.33 - perplexity -1.02
2023-01-30 04:51:22,303:INFO: - Elapsed time: 1532.89, lr: 0.00010
2023-01-30 04:51:22,304:INFO: Epoch 30/30
2023-01-30 05:14:23,465:INFO: - Training:  - 1381s - loss: 0.0054 - perplexity: 1.0054 - lr: 0.0001
2023-01-30 05:16:56,397:INFO: - Eval: BLEU-4 98.46 - EM 92.76 - Edit 98.11 - perplexity -1.02
2023-01-30 05:16:56,399:INFO: - New best score (-1.02)!
2023-01-30 05:16:57,677:INFO: - Saved model in results/clean-RDKit-100K/model.weights/
2023-01-30 05:16:57,678:INFO: - Elapsed time: 1535.37, lr: 0.00010
2023-01-30 20:48:52,522:INFO: Building model...
2023-01-30 20:48:55,322:INFO: - done.
2023-01-30 20:48:55,323:INFO: Reloading the latest trained model...
2023-01-30 20:48:55,325:INFO: Restoring parameters from results/clean-RDKit-100K/model.weights/
2023-01-30 20:51:40,437:INFO: - Test Txt: BLEU-4 98.41 - EM 92.45 - Edit 98.09 - perplexity -1.02
